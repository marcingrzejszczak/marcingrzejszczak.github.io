<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
  <meta charset="utf-8">
  <title>Spring Cloud Contract 1.0.0.RELEASE Available! - TOO MUCH CODING</title>
  <meta name="author" content="Marcin Grzejszczak">

  
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="https://toomuchcoding.com/blog/2016/09/24/spring-cloud-contract-1-dot-0-0-dot-release-available/">
  <link href="/favicon.png" type="image/png" rel="icon">
  <link href="/atom.xml" rel="alternate" title="TOO MUCH CODING" type="application/atom+xml">

  <!-- http://opengraphprotocol.org/ -->
  <meta name="twitter:card" content="summary_large_image">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://toomuchcoding.com/blog/2016/09/24/spring-cloud-contract-1-dot-0-0-dot-release-available/">
  <meta property="og:title" content="Spring Cloud Contract 1.0.0.RELEASE Available! - TOO MUCH CODING">
  

  <script src="/javascripts/libs/jquery/jquery-2.1.3.min.js"></script>

<link href="/assets/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/assets/bootstrap/dist/css/bootstrap-theme.min.css" rel="stylesheet" type="text/css">


  
  <link href="/stylesheets/screen.css" media="screen, projection, print" rel="stylesheet" type="text/css">

  

</head>

  <body   >
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="wrap">
      <header role="banner">
        <nav class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" title="toggle navbar" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">TOO MUCH CODING</a>
        </div>

        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li class="active">
                    <a rel="index" href="/">Blog</a>
                </li>
                <li >
                    <a href="/blog/archives">Archives</a>
                </li>
                <li >
                    <a href="/oss">OSS</a>
                </li>
                <li >
                    <a href="/abstracts">Abstracts</a>
                </li>
                <li >
                    <a href="/talks">Talks</a>
                </li>
                <li >
                    <a href="/publications">Publications</a>
                </li>
                <li >
                    <a href="/bio">Bio</a>
                </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a class="subscribe-rss" href="/atom.xml" title="subscribe via RSS">
                        <span class="visible-xs">RSS</span>
                        <img class="hidden-xs" src="/images/rss.png" alt="RSS">
                    </a>
                </li>
                
            </ul>
            
                <form class="navbar-form navbar-right" action="https://www.google.com/search" method="GET">
                    <input type="hidden" name="sitesearch" value="toomuchcoding.com">
                    <div class="form-group">
                        <input class="form-control" type="text" name="q" placeholder="Search">
                    </div>
                </form>
            
        </div>
    </div>
</nav>


      </header>
      <div id="main" role="main" class="container">
        <div id="content">
          <div class="row">
  <div class="page-content col-md-9" itemscope itemtype="http://schema.org/Blog">
    <meta itemprop="name" content="TOO MUCH CODING" />
    <meta itemprop="description" content="A blog for coding addicts about Java, Groovy, Buzzword, Spring, Microservices, Buzzword" />
    <meta itemprop="url" content="https://toomuchcoding.com" />
    <article class="hentry" role="article" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
      
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2016-09-24T20:39:25+02:00"  data-updated="true" itemprop="datePublished dateCreated">ordinal</time>
        
           | <a href="#disqus_thread" itemprop="discussionUrl"
             data-disqus-identifier="https://toomuchcoding.com">Comments</a>
        
      </p>
    
    
    <h1 class="entry-title" itemprop="name headline">
        Spring Cloud Contract 1.0.0.RELEASE Available!
        
    </h1>
    
  </header>


<div class="entry-content clearfix" itemprop="articleBody description"><p>I&rsquo;ve just published an article at the Spring blog about <a href="https://spring.io/blog/2016/09/23/spring-cloud-contract-1-0-0-release-is-available">Spring Cloud Contract 1.0.0.RELEASE is available</a>.</p>

<p>I&rsquo;m really happy that the project is GA. Even though as the Accurest project we had already done a GA release, it really feels that a lot of effort was put in order to release the GA version under the Pivotal&rsquo;s Spring Cloud branding. Let&rsquo;s look at some numbers:</p>

<ul>
<li>first commit almost 2 years ago: <a href="https://github.com/spring-cloud/spring-cloud-contract/commit/dfaddaa98d645b818ba3947c9267ef7ac8ed9ba4">2014-12-06 18:20:29 by Jakub Kubrynski</a> - thanks to <a href="http://codearte.eu">Codearte</a> the authors of <a href="http://devskiller.com">DevSkiller</a> for their support!!!</li>
<li><a href="https://github.com/spring-cloud/spring-cloud-contract/commits/master">1.152 commits</a></li>
<li><a href="https://github.com/spring-cloud/spring-cloud-contract/graphs/contributors">20 contributors</a></li>
</ul>


<p>That&rsquo;s quite a lot of work! But there we are, with a library that has already been battle-proven on production by many companies, even before being GA as Spring Cloud Contract.</p>

<!-- more -->


<h2>What&rsquo;s new in comparison to Accurest?</h2>

<p>Like I mentioned, Accurest was already GA. So what are the main difference apart from rebranding and bug fixes?</p>

<ul>
<li>we&rsquo;ve moved from Grapes to Aether to download stubs</li>
<li><a href="https://cloud.spring.io/spring-cloud-contract/spring-cloud-contract.html#_what_is_this_value_consumer_producer">we generate fake data when you provide either consumer or producer in the DSL</a></li>
<li><a href="https://cloud.spring.io/spring-cloud-contract/spring-cloud-contract.html#_common_repo_with_contracts">Consumer Contract approach is there</a></li>
<li>Spring Cloud Contract is available on <a href="http://start.spring.io">start.spring.io</a></li>
<li><a href="https://cloud.spring.io/spring-cloud-contract/spring-cloud-contract.html#_different_base_classes_for_contracts_2">you can have more than one base class for your tests</a></li>
<li><a href="https://cloud.spring.io/spring-cloud-contract/spring-cloud-contract.html#_additional_configuration">Spring Cloud Stub Runner Boot can register stubs in Eureka / Consul / Zookeeper using Spring Cloud</a></li>
<li>the whole build was moved from Gradle to the standard Spring Cloud Maven setup</li>
</ul>


<p>These are the Spring Cloud Contract Verifier changes. Apart from that Spring Cloud Contract consists of <a href="https://cloud.spring.io/spring-cloud-contract/spring-cloud-contract.html#_spring_cloud_contract_wiremock">Spring Cloud Contract WireMock support</a> and <a href="https://cloud.spring.io/spring-cloud-contract/spring-cloud-contract.html#_generating_stubs_using_restdocs">Spring Cloud Contract RestDocs</a>. Thanks to the first one the integration with <a href="http://wiremock.org">WireMock</a> is much more efficient and thanks to the latter you don&rsquo;t have to use the Groovy DSL - you can define your stubs by yourself by attaching them to an existing RestDocs test.</p>

<p>As far as Spring Cloud Contract Verifier is concerned the biggest two changes are the <a href="https://cloud.spring.io/spring-cloud-contract/spring-cloud-contract.html#_common_repo_with_contracts">Consumer Contract support</a> and that <a href="https://cloud.spring.io/spring-cloud-contract/spring-cloud-contract.html#_different_base_classes_for_contracts_2">you can have more than one base class for your tests</a>. Let&rsquo;s take a closer look what&rsquo;s there in the docs about them&hellip;</p>

<h3>Consumer Contract support</h3>

<p>Another way of storing contracts other than having them with the producer is keeping them in a common place. It can be related to security issues where the consumers can’t clone the producer’s code. Also if you keep contracts in a single place then you, as a producer, will know how many consumers you have and which consumer will you break with your local changes.</p>

<h4>Repo structure</h4>

<p>Let’s assume that we have a producer with coordinates com.example:server and 3 consumers: client1, client2, client3. Then in the repository with common contracts you would have the following setup (which you can checkout here:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>├── com
</span><span class='line'>│   └── example
</span><span class='line'>│       └── server
</span><span class='line'>│           ├── client1
</span><span class='line'>│           │   └── expectation.groovy
</span><span class='line'>│           ├── client2
</span><span class='line'>│           │   └── expectation.groovy
</span><span class='line'>│           ├── client3
</span><span class='line'>│           │   └── expectation.groovy
</span><span class='line'>│           └── pom.xml
</span><span class='line'>├── mvnw
</span><span class='line'>├── mvnw.cmd
</span><span class='line'>├── pom.xml
</span><span class='line'>└── src
</span><span class='line'>    └── assembly
</span><span class='line'>        └── contracts.xml</span></code></pre></td></tr></table></div></figure>


<p>As you can see the under the slash-delimited groupid / artifact id folder (<code>com/example/server</code>) you have expectations of the 3 consumers (<code>client1</code>, <code>client2</code> and <code>client3</code>). Expectations are the standard Groovy DSL contract files as described throughout this documentation. This repository has to produce a JAR file that maps one to one to the contents of the repo.</p>

<p>Example of a <code>pom.xml</code> inside the <code>server</code> folder.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
</span><span class='line'>&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
</span><span class='line'>  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
</span><span class='line'>  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
</span><span class='line'>
</span><span class='line'>  &lt;groupId&gt;com.example&lt;/groupId&gt;
</span><span class='line'>  &lt;artifactId&gt;server&lt;/artifactId&gt;
</span><span class='line'>  &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
</span><span class='line'>
</span><span class='line'>  &lt;name&gt;Server Stubs&lt;/name&gt;
</span><span class='line'>  &lt;description&gt;POM used to install locally stubs for consumer side&lt;/description&gt;
</span><span class='line'>
</span><span class='line'>  &lt;parent&gt;
</span><span class='line'>      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
</span><span class='line'>      &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
</span><span class='line'>      &lt;version&gt;1.4.0.BUILD-SNAPSHOT&lt;/version&gt;
</span><span class='line'>      &lt;relativePath /&gt;
</span><span class='line'>  &lt;/parent&gt;
</span><span class='line'>
</span><span class='line'>  &lt;properties&gt;
</span><span class='line'>      &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
</span><span class='line'>      &lt;java.version&gt;1.8&lt;/java.version&gt;
</span><span class='line'>      &lt;spring-cloud-contract.version&gt;1.0.1.BUILD-SNAPSHOT&lt;/spring-cloud-contract.version&gt;
</span><span class='line'>      &lt;spring-cloud-dependencies.version&gt;Camden.BUILD-SNAPSHOT&lt;/spring-cloud-dependencies.version&gt;
</span><span class='line'>  &lt;/properties&gt;
</span><span class='line'>
</span><span class='line'>  &lt;dependencyManagement&gt;
</span><span class='line'>      &lt;dependencies&gt;
</span><span class='line'>          &lt;dependency&gt;
</span><span class='line'>              &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
</span><span class='line'>              &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;
</span><span class='line'>              &lt;version&gt;${spring-cloud-dependencies.version}&lt;/version&gt;
</span><span class='line'>              &lt;type&gt;pom&lt;/type&gt;
</span><span class='line'>              &lt;scope&gt;import&lt;/scope&gt;
</span><span class='line'>          &lt;/dependency&gt;
</span><span class='line'>      &lt;/dependencies&gt;
</span><span class='line'>  &lt;/dependencyManagement&gt;
</span><span class='line'>
</span><span class='line'>  &lt;build&gt;
</span><span class='line'>      &lt;plugins&gt;
</span><span class='line'>          &lt;plugin&gt;
</span><span class='line'>              &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
</span><span class='line'>              &lt;artifactId&gt;spring-cloud-contract-maven-plugin&lt;/artifactId&gt;
</span><span class='line'>              &lt;version&gt;${spring-cloud-contract.version}&lt;/version&gt;
</span><span class='line'>              &lt;extensions&gt;true&lt;/extensions&gt;
</span><span class='line'>              &lt;configuration&gt;
</span><span class='line'>                  &lt;!-- By default it would search under src/test/resources/ --&gt;
</span><span class='line'>                  &lt;contractsDirectory&gt;${project.basedir}&lt;/contractsDirectory&gt;
</span><span class='line'>              &lt;/configuration&gt;
</span><span class='line'>          &lt;/plugin&gt;
</span><span class='line'>      &lt;/plugins&gt;
</span><span class='line'>  &lt;/build&gt;
</span><span class='line'>
</span><span class='line'>  &lt;repositories&gt;
</span><span class='line'>      &lt;repository&gt;
</span><span class='line'>          &lt;id&gt;spring-snapshots&lt;/id&gt;
</span><span class='line'>          &lt;name&gt;Spring Snapshots&lt;/name&gt;
</span><span class='line'>          &lt;url&gt;https://repo.spring.io/snapshot&lt;/url&gt;
</span><span class='line'>          &lt;snapshots&gt;
</span><span class='line'>              &lt;enabled&gt;true&lt;/enabled&gt;
</span><span class='line'>          &lt;/snapshots&gt;
</span><span class='line'>      &lt;/repository&gt;
</span><span class='line'>      &lt;repository&gt;
</span><span class='line'>          &lt;id&gt;spring-milestones&lt;/id&gt;
</span><span class='line'>          &lt;name&gt;Spring Milestones&lt;/name&gt;
</span><span class='line'>          &lt;url&gt;https://repo.spring.io/milestone&lt;/url&gt;
</span><span class='line'>          &lt;snapshots&gt;
</span><span class='line'>              &lt;enabled&gt;false&lt;/enabled&gt;
</span><span class='line'>          &lt;/snapshots&gt;
</span><span class='line'>      &lt;/repository&gt;
</span><span class='line'>      &lt;repository&gt;
</span><span class='line'>          &lt;id&gt;spring-releases&lt;/id&gt;
</span><span class='line'>          &lt;name&gt;Spring Releases&lt;/name&gt;
</span><span class='line'>          &lt;url&gt;https://repo.spring.io/release&lt;/url&gt;
</span><span class='line'>          &lt;snapshots&gt;
</span><span class='line'>              &lt;enabled&gt;false&lt;/enabled&gt;
</span><span class='line'>          &lt;/snapshots&gt;
</span><span class='line'>      &lt;/repository&gt;
</span><span class='line'>  &lt;/repositories&gt;
</span><span class='line'>  &lt;pluginRepositories&gt;
</span><span class='line'>      &lt;pluginRepository&gt;
</span><span class='line'>          &lt;id&gt;spring-snapshots&lt;/id&gt;
</span><span class='line'>          &lt;name&gt;Spring Snapshots&lt;/name&gt;
</span><span class='line'>          &lt;url&gt;https://repo.spring.io/snapshot&lt;/url&gt;
</span><span class='line'>          &lt;snapshots&gt;
</span><span class='line'>              &lt;enabled&gt;true&lt;/enabled&gt;
</span><span class='line'>          &lt;/snapshots&gt;
</span><span class='line'>      &lt;/pluginRepository&gt;
</span><span class='line'>      &lt;pluginRepository&gt;
</span><span class='line'>          &lt;id&gt;spring-milestones&lt;/id&gt;
</span><span class='line'>          &lt;name&gt;Spring Milestones&lt;/name&gt;
</span><span class='line'>          &lt;url&gt;https://repo.spring.io/milestone&lt;/url&gt;
</span><span class='line'>          &lt;snapshots&gt;
</span><span class='line'>              &lt;enabled&gt;false&lt;/enabled&gt;
</span><span class='line'>          &lt;/snapshots&gt;
</span><span class='line'>      &lt;/pluginRepository&gt;
</span><span class='line'>      &lt;pluginRepository&gt;
</span><span class='line'>          &lt;id&gt;spring-releases&lt;/id&gt;
</span><span class='line'>          &lt;name&gt;Spring Releases&lt;/name&gt;
</span><span class='line'>          &lt;url&gt;https://repo.spring.io/release&lt;/url&gt;
</span><span class='line'>          &lt;snapshots&gt;
</span><span class='line'>              &lt;enabled&gt;false&lt;/enabled&gt;
</span><span class='line'>          &lt;/snapshots&gt;
</span><span class='line'>      &lt;/pluginRepository&gt;
</span><span class='line'>  &lt;/pluginRepositories&gt;
</span><span class='line'>
</span><span class='line'>&lt;/project&gt;</span></code></pre></td></tr></table></div></figure>


<p>As you can see there are no dependencies other than the Spring Cloud Contract Verifier Maven plugin. Those poms are necessary for the consumer side to run <code>mvn clean install -DskipTests</code> to locally install stubs of the producer project.</p>

<p>The <code>pom.xml</code> in the root folder can look like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
</span><span class='line'>&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
</span><span class='line'>       xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
</span><span class='line'>  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
</span><span class='line'>
</span><span class='line'>  &lt;groupId&gt;com.example.standalone&lt;/groupId&gt;
</span><span class='line'>  &lt;artifactId&gt;contracts&lt;/artifactId&gt;
</span><span class='line'>  &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
</span><span class='line'>
</span><span class='line'>  &lt;name&gt;Contracts&lt;/name&gt;
</span><span class='line'>  &lt;description&gt;Contains all the Spring Cloud Contracts, well, contracts. JAR used by the producers to generate tests and stubs&lt;/description&gt;
</span><span class='line'>
</span><span class='line'>  &lt;properties&gt;
</span><span class='line'>      &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
</span><span class='line'>  &lt;/properties&gt;
</span><span class='line'>
</span><span class='line'>  &lt;build&gt;
</span><span class='line'>      &lt;plugins&gt;
</span><span class='line'>          &lt;plugin&gt;
</span><span class='line'>              &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
</span><span class='line'>              &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;
</span><span class='line'>              &lt;executions&gt;
</span><span class='line'>                  &lt;execution&gt;
</span><span class='line'>                      &lt;id&gt;contracts&lt;/id&gt;
</span><span class='line'>                      &lt;phase&gt;prepare-package&lt;/phase&gt;
</span><span class='line'>                      &lt;goals&gt;
</span><span class='line'>                          &lt;goal&gt;single&lt;/goal&gt;
</span><span class='line'>                      &lt;/goals&gt;
</span><span class='line'>                      &lt;configuration&gt;
</span><span class='line'>                          &lt;attach&gt;true&lt;/attach&gt;
</span><span class='line'>                          &lt;descriptor&gt;${basedir}/src/assembly/contracts.xml&lt;/descriptor&gt;
</span><span class='line'>                          &lt;!-- If you want an explicit classifier remove the following line --&gt;
</span><span class='line'>                          &lt;appendAssemblyId&gt;false&lt;/appendAssemblyId&gt;
</span><span class='line'>                      &lt;/configuration&gt;
</span><span class='line'>                  &lt;/execution&gt;
</span><span class='line'>              &lt;/executions&gt;
</span><span class='line'>          &lt;/plugin&gt;
</span><span class='line'>      &lt;/plugins&gt;
</span><span class='line'>  &lt;/build&gt;
</span><span class='line'>
</span><span class='line'>&lt;/project&gt;</span></code></pre></td></tr></table></div></figure>


<p>It’s using the assembly plugin in order to build the JAR with all the contracts. Example of such setup is here:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;assembly xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.3"
</span><span class='line'>        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
</span><span class='line'>        xsi:schemaLocation="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.3 http://maven.apache.org/xsd/assembly-1.1.3.xsd"&gt;
</span><span class='line'>  &lt;id&gt;project&lt;/id&gt;
</span><span class='line'>  &lt;formats&gt;
</span><span class='line'>      &lt;format&gt;jar&lt;/format&gt;
</span><span class='line'>  &lt;/formats&gt;
</span><span class='line'>  &lt;includeBaseDirectory&gt;false&lt;/includeBaseDirectory&gt;
</span><span class='line'>  &lt;fileSets&gt;
</span><span class='line'>      &lt;fileSet&gt;
</span><span class='line'>          &lt;directory&gt;${project.basedir}&lt;/directory&gt;
</span><span class='line'>          &lt;outputDirectory&gt;/&lt;/outputDirectory&gt;
</span><span class='line'>          &lt;useDefaultExcludes&gt;true&lt;/useDefaultExcludes&gt;
</span><span class='line'>          &lt;excludes&gt;
</span><span class='line'>              &lt;exclude&gt;**/${project.build.directory}/**&lt;/exclude&gt;
</span><span class='line'>              &lt;exclude&gt;mvnw&lt;/exclude&gt;
</span><span class='line'>              &lt;exclude&gt;mvnw.cmd&lt;/exclude&gt;
</span><span class='line'>              &lt;exclude&gt;.mvn/**&lt;/exclude&gt;
</span><span class='line'>              &lt;exclude&gt;src/**&lt;/exclude&gt;
</span><span class='line'>          &lt;/excludes&gt;
</span><span class='line'>      &lt;/fileSet&gt;
</span><span class='line'>  &lt;/fileSets&gt;
</span><span class='line'>&lt;/assembly&gt;</span></code></pre></td></tr></table></div></figure>


<h4>Workflow</h4>

<p>The workflow would look similar to the one presented in the <a href="https://cloud.spring.io/spring-cloud-contract/spring-cloud-contract.html#_step_by_step_guide_to_cdc">Step by step guide to CDC</a>. The only difference is that the producer doesn’t own the contracts anymore. So the consumer and the producer have to work on common contracts in a common repository.</p>

<h4>Consumer</h4>

<p>When the consumer wants to work on the contracts offline, instead of cloning the producer code, the consumer team clones the common repository, goes to the required producer’s folder (e.g. <code>com/example/server</code>) and runs <code>mvn clean install -DskipTests</code> to install locally the stubs converted from the contracts.</p>

<p><strong>REMEMBER! You need to have Maven installed locally</strong></p>

<h4>Producer</h4>

<p>As a producer it’s enough to alter the Spring Cloud Contract Verifier to provide the URL and the dependency of the JAR containing the contracts:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;plugin&gt;
</span><span class='line'>  &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
</span><span class='line'>  &lt;artifactId&gt;spring-cloud-contract-maven-plugin&lt;/artifactId&gt;
</span><span class='line'>  &lt;configuration&gt;
</span><span class='line'>      &lt;contractsRepositoryUrl&gt;http://link/to/your/nexus/or/artifactory/or/sth&lt;/contractsRepositoryUrl&gt;
</span><span class='line'>      &lt;contractDependency&gt;
</span><span class='line'>          &lt;groupId&gt;com.example.standalone&lt;/groupId&gt;
</span><span class='line'>          &lt;artifactId&gt;contracts&lt;/artifactId&gt;
</span><span class='line'>      &lt;/contractDependency&gt;
</span><span class='line'>  &lt;/configuration&gt;
</span><span class='line'>&lt;/plugin&gt;</span></code></pre></td></tr></table></div></figure>


<p>With this setup the JAR with groupid <code>com.example.standalone</code> and artifactid contracts will be downloaded from <code>http://link/to/your/nexus/or/artifactory/or/sth</code>. It will be then unpacked in a local temporary folder and contracts present under the <code>com/example/server</code> will be picked as the ones used to generate the tests and the stubs. Due to this convention the producer team will know which consumer teams will be broken when some incompatible changes are done.</p>

<p>The rest of the flow looks the same.</p>

<h3>More than one base class</h3>

<p>That was quite a problem when providing one single base class for all the tests. After some time the mock configurations were enormous! That&rsquo;s why we&rsquo;ve added a possibility to map a contract to its test base class.</p>

<h4>Gradle</h4>

<p>If your base classes differ between contracts you can tell the Spring Cloud Contract plugin which class should get extended by the autogenerated tests. You have two options:</p>

<ul>
<li>follow a convention by providing the <code>packageWithBaseClasses</code></li>
<li>provide explicit mapping via <code>baseClassMappings</code></li>
</ul>


<h5>Convention</h5>

<p>The convention is such that if you have a contract under e.g. <code>src/test/resources/contract/foo/bar/baz/</code> and provide the value of the <code>packageWithBaseClasses</code> property to <code>com.example.base</code> then we will assume that there is a <code>BarBazBase</code> class under <code>com.example.base</code> package. In other words we take last two parts of package if they exist and form a class with a <code>Base</code> suffix. Takes precedence over <code>baseClassForTests</code>. Example of usage in the contracts closure:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>packageWithBaseClasses = 'com.example.base'</span></code></pre></td></tr></table></div></figure>


<h5>Mapping</h5>

<p>You can manually map a regular expression of the contract’s <em>package</em> (package, not folder) to fully qualified name of the base class for the matched contract. Let’s take a look at the following example:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>baseClassForTests = "com.example.FooBase"
</span><span class='line'>baseClassMappings {
</span><span class='line'>  baseClassMapping('.*com.*', 'com.example.ComBase')
</span><span class='line'>  baseClassMapping('.*bar.*':'com.example.BarBase')
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Let’s assume that you have contracts under</p>

<ul>
<li><code>src/test/resources/contract/com/</code></li>
<li><code>src/test/resources/contract/foo/</code></li>
</ul>


<p>By providing the <code>baseClassForTests</code> we have a fallback in case mapping didn’t succeed (you could also provide the <code>packageWithBaseClasses</code> as fallback). That way the tests generated from <code>src/test/resources/contract/com/</code> contracts will be extending the <code>com.example.ComBase</code> whereas the rest of tests will extend <code>com.example.FooBase</code> cause they don&rsquo;t match the base class mapping for <code>bar</code> folder.</p>

<h4>Maven</h4>

<p>Let&rsquo;s now look how it looks like for Maven.</p>

<h5>Convention</h5>

<p>To accomplish the same result as the one presented for Gradle you&rsquo;d have to set your configuration like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;plugin&gt;
</span><span class='line'>  &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
</span><span class='line'>  &lt;artifactId&gt;spring-cloud-contract-maven-plugin&lt;/artifactId&gt;
</span><span class='line'>  &lt;configuration&gt;
</span><span class='line'>      &lt;packageWithBaseClasses&gt;com.example.base&lt;/packageWithBaseClasses&gt;
</span><span class='line'>  &lt;/configuration&gt;
</span><span class='line'>&lt;/plugin&gt;</span></code></pre></td></tr></table></div></figure>


<h5>Mapping</h5>

<p>You can manually map a regular expression of the contract’s package to fully qualified name of the base class for the matched contract. You have to provide a list <code>baseClassMappings</code> of <code>baseClassMapping</code> that takes a <code>contractPackageRegex</code> to <code>baseClassFQN</code> mapping. Let’s take a look at the following example:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;plugin&gt;
</span><span class='line'>  &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
</span><span class='line'>  &lt;artifactId&gt;spring-cloud-contract-maven-plugin&lt;/artifactId&gt;
</span><span class='line'>  &lt;configuration&gt;
</span><span class='line'>      &lt;baseClassForTests&gt;com.example.FooBase&lt;/baseClassForTests&gt;
</span><span class='line'>      &lt;baseClassMappings&gt;
</span><span class='line'>          &lt;baseClassMapping&gt;
</span><span class='line'>              &lt;contractPackageRegex&gt;.*com.*&lt;/contractPackageRegex&gt;
</span><span class='line'>              &lt;baseClassFQN&gt;com.example.ComBase&lt;/baseClassFQN&gt;
</span><span class='line'>          &lt;/baseClassMapping&gt;
</span><span class='line'>              &lt;baseClassMapping&gt;
</span><span class='line'>                  &lt;contractPackageRegex&gt;.*bar.*&lt;/contractPackageRegex&gt;
</span><span class='line'>                  &lt;baseClassFQN&gt;com.example.BarBase&lt;/baseClassFQN&gt;
</span><span class='line'>              &lt;/baseClassMapping&gt;
</span><span class='line'>      &lt;/baseClassMappings&gt;
</span><span class='line'>  &lt;/configuration&gt;
</span><span class='line'>&lt;/plugin&gt;</span></code></pre></td></tr></table></div></figure>


<h2>Summary</h2>

<p>In this blog post we&rsquo;ve checked what are the new and shiny features in the GA of Spring Cloud Contract. We&rsquo;ve also checked some history around Accurest to Spring Cloud Contract migration.</p>

<h2>Links</h2>

<p>Here you can find interesting links related to Spring Cloud Contract Verifier:</p>

<ul>
<li><a href="https://github.com/spring-cloud/spring-cloud-contract/">Spring Cloud Contract Github Repository</a></li>
<li><a href="https://cloud.spring.io/spring-cloud-contract/">Spring Cloud Contract Main project page</a></li>
<li><a href="https://cloud.spring.io/spring-cloud-contract/spring-cloud-contract.html">Spring Cloud Contract Documentation</a></li>
<li><a href="https://cloud.spring.io/spring-cloud-contract/spring-cloud-contract.html#_spring_cloud_contract_stub_runner">Spring Cloud Contract Stub Runner Documentation</a></li>
<li><a href="https://gitter.im/spring-cloud/spring-cloud-contract">Spring Cloud Contract Gitter</a></li>
<li><a href="https://cloud.spring.io/spring-cloud-contract/spring-cloud-contract-maven-plugin/">Spring Cloud Contract Maven Plugin Documentation</a></li>
</ul>

</div>


      <footer>
        <p class="meta text-muted">
          
  

<span class="glyphicon glyphicon-user"></span> <span class="byline author vcard" itemprop="author" itemscope itemtype="http://schema.org/Person">Posted by <span class="fn" itemprop="name">Marcin Grzejszczak</span></span>

          












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2016-09-24T20:39:25+02:00"  data-updated="true" itemprop="datePublished dateCreated">ordinal</time>
          

<span class="glyphicon glyphicon-tags"></span>&nbsp;
<span class="categories">
  
    <a class='category' href='/blog/categories/accurest/'>accurest</a>, <a class='category' href='/blog/categories/cdc/'>cdc</a>, <a class='category' href='/blog/categories/consumer-driven-contracts/'>consumer-driven-contracts</a>, <a class='category' href='/blog/categories/deployment/'>deployment</a>, <a class='category' href='/blog/categories/spring-cloud/'>spring-cloud</a>, <a class='category' href='/blog/categories/spring-cloud-contract/'>spring-cloud-contract</a>
  
</span>


        </p>
        
          <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="https://toomuchcoding.com/blog/2016/09/24/spring-cloud-contract-1-dot-0-0-dot-release-available/" data-via="mgrzejszczak" data-counturl="https://toomuchcoding.com/blog/2016/09/24/spring-cloud-contract-1-dot-0-0-dot-release-available/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

        
        
          <ul class="meta text-muted pager">
            
            <li class="previous"><a href="/blog/2016/07/25/spring-cloud-contract-1-dot-0-0-dot-m1-released/" title="Previous Post: Spring Cloud Contract 1.0.0.M1 Released">&laquo; Spring Cloud Contract 1.0.0.M1 Released</a></li>
            
            
            <li class="next"><a href="/blog/2016/10/07/spring-cloud-contract-podcast/" title="Next Post: Spring Cloud Contract Podcast">Spring Cloud Contract Podcast &raquo;</a></li>
            
          </ul>
        
      </footer>
    </article>
    
      <section>
        <h2>Comments</h2>
        <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
      </section>
    
  </div>

  
  <aside class="sidebar col-md-3">
    
      <section>
  <h1>About Me</h1>
  <p><img src="/images/ja.jpeg" style="float:left;margin:5px;border-width:0px;width:100%;height:100%"/>
  Author of <a href="https://www.packtpub.com/application-development/instant-mockito">"Mockito Instant"</a> and <a href="https://www.packtpub.com/application-development/mockito-cookbook">"Mockito Cookbook"</a> books. Author of <a href="https://learning.oreilly.com/videos/hands-on-guide-to/9780135598436">Hands-On Guide to Spring Cloud Contract: Creating Consumer-Driven Contracts to Leverage Contract Tests and Improve Your Code</a> and co-author of <a href="http://bit.ly/appliedCD">Applied Continuous Delivery Live Lessons</a>. Co-founder of the Warsaw Groovy User Group, <a href="https://www.meetup.com/Warsaw-Cloud-Native-Meetup/">Warsaw Cloud Native Meetup</a> and the <a href="http://www.diverseit.io">DiverseIT</a> initiative.
  </p>

  <p>
  Lead of <a href="https://cloud.spring.io/spring-cloud-sleuth/">Spring Cloud Sleuth</a>, <a href="https://cloud.spring.io/spring-cloud-contract/">Spring Cloud Contract</a> and <a href="https://spring.io/blog/2018/11/13/spring-cloud-pipelines-to-cloud-pipelines-migration">Cloud Pipelines</a> projects at <a href="http://spring.io">Pivotal</a>
  </p>

  <p><a href="https://github.com/marcingrzejszczak">Github profile</a></p>

  <p><a href="https://twitter.com/MGrzejszczak">Twitter: @MGrzejszczak</a></p>

  <p><a href="https://www.goodreads.com/author/show/7284553.Marcin_Grzejszczak">Goodreads account</a></p>
</section>
<section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Recent Posts</h3>
  </div>
  
  <div id="recent_posts" class="list-group">
    
    <a class="list-group-item " href="/blog/2018/02/13/spring-cloud-contract-in-the-polyglot-world/">Spring Cloud Contract in the Polyglot World</a>
    
    <a class="list-group-item " href="/blog/2017/12/03/continuous-delivery-of-a-startup/">Continuous Delivery of a Startup</a>
    
    <a class="list-group-item " href="/blog/2016/10/18/new-project-spring-cloud-pipelines/">New Project - Spring Cloud Pipelines</a>
    
    <a class="list-group-item " href="/blog/2016/10/07/spring-cloud-contract-podcast/">Spring Cloud Contract Podcast</a>
    
    <a class="list-group-item active" href="/blog/2016/09/24/spring-cloud-contract-1-dot-0-0-dot-release-available/">Spring Cloud Contract 1.0.0.RELEASE Available!</a>
    
  </div>
</section>


<section class="googleplus panel panel-default">
  <div class="panel-body">
    <h2>
      <a href="https://plus.google.com/108408840893580782990?rel=author">
        <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
        Google+
      </a>
    </h2>
  </div>
</section>



    
  </aside>
  
</div>

        </div>
      </div>
    </div>
    <footer role="contentinfo"><div class="container">
    <p class="text-muted credits">
  Copyright &copy; 2019 - Marcin Grzejszczak<br>
  <small>
      <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>,
      <span class="credit">customized with <a href="https://github.com/kAworu/octostrap3">octostrap3</a></span>.
  </small>
</p>

</div>
</footer>
    

<script type="text/javascript">
      var disqus_shortname = 'toomuchcoding';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'https://toomuchcoding.com/blog/2016/09/24/spring-cloud-contract-1-dot-0-0-dot-release-available/';
        var disqus_url = 'https://toomuchcoding.com/blog/2016/09/24/spring-cloud-contract-1-dot-0-0-dot-release-available/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


<script src="/assets/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/javascripts/modernizr.js"></script>


  </body>
</html>
